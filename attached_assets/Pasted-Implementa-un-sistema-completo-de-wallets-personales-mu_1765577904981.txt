Implementa un sistema completo de wallets personales multi-token en la red TON para la plataforma existente.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CONTEXTO ACTUAL DEL PROYECTO:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- Token B3C ya implementado como Jetton en TON
- Sistema de wallet pool existente con consolidaciÃ³n al hot wallet
- Usuarios usan wallets temporales del pool para recargar
- Flask backend + tonsdk para operaciones TON

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ARQUITECTURA DEL NUEVO SISTEMA:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. WALLET PERSONAL PERMANENTE POR USUARIO
   - Crear wallet TON Ãºnica al registrar usuario (o primera visita)
   - Guardar: direcciÃ³n pÃºblica + mnemonic encriptado (AES-256)
   - Esta wallet es PROPIEDAD del usuario (puede retirar)
   - NO se consolidan fondos automÃ¡ticamente (quedan en wallet del usuario)
   - Mostrar siempre la misma direcciÃ³n (QR + botÃ³n copiar)

2. TOKENS SOPORTADOS (en orden de prioridad UI):
   PRINCIPALES (siempre visibles):
   - B3C: Nuestro token (contrato: [usar el existente])
   - USDT: EQCxE6mUtQJKFnGfaROTKOt1lZbDiiX1kCixRv7Nw2Id_sDs
   - TON: Nativo
   
   DETECCIÃ“N AUTOMÃTICA:
   - Detectar y mostrar CUALQUIER Jetton que depositen
   - Consultar metadata del Jetton (nombre, sÃ­mbolo, decimales)
   - Mostrar en secciÃ³n "Otros Tokens" debajo de los principales

3. FLUJO DE DEPÃ“SITOS:
   Usuario deposita â†’ Sistema detecta tx entrante â†’
   Identifica tipo de token (por contrato Jetton) â†’
   Actualiza balance del token correspondiente â†’
   NO convierte automÃ¡ticamente (usuario mantiene el token original) â†’
   Notifica al usuario del depÃ³sito recibido

4. FLUJO DE RETIROS:
   Usuario solicita retiro de X token â†’
   Sistema calcula: monto + gas fee + comisiÃ³n plataforma â†’
   Descuenta TODO del balance del usuario â†’
   Ejecuta transferencia desde wallet del usuario â†’
   Registra transacciÃ³n

   COMISIONES RETIRO:
   - Gas fee de red: Se cobra del balance del usuario
   - ComisiÃ³n plataforma: Configurable por admin (% o fijo)

5. USO DE TOKENS EN PLATAFORMA:
   - SOLO B3C sirve para: compras marketplace, bots, funciones internas
   - USDT/TON/otros: Solo para mantener, transferir, retirar
   - Para usar servicios: Usuario debe convertir a B3C primero

6. CONSOLIDACIÃ“N (CASOS ESPECÃFICOS):
   MANTENER consolidaciÃ³n SOLO para:
   - Marketplace P2P (escrow para evitar estafas)
   - Compras directas de B3C desde bots/funciones especiales
   
   NO consolidar:
   - DepÃ³sitos normales a wallet personal
   - Tokens que el usuario quiere mantener

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
UI/UX - SECCIÃ“N "MIS ACTIVOS":
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VISTA PRINCIPAL:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¼ Mis Activos                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [QR CODE]                           â”‚
â”‚ Tu direcciÃ³n de depÃ³sito:           â”‚
â”‚ UQBxx...xxx [ğŸ“‹ Copiar]             â”‚
â”‚ Acepta: TON, USDT, B3C y mÃ¡s        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOKENS PRINCIPALES                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸª™ B3C         1,250.00    [â†’]  â”‚ â”‚
â”‚ â”‚ ğŸ’µ USDT          50.00    [â†’]  â”‚ â”‚
â”‚ â”‚ ğŸ’ TON            2.50    [â†’]  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OTROS TOKENS                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ• DOGS         100.00    [â†’]  â”‚ â”‚
â”‚ â”‚ ğŸ¹ HMSTR        500.00    [â†’]  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AL HACER CLICK EN TOKEN [â†’]:
- Ver balance detallado
- Historial de transacciones de ese token
- BotÃ³n "Retirar"
- BotÃ³n "Enviar" (a otro usuario interno)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
BASE DE DATOS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Wallet personal del usuario
CREATE TABLE user_wallets (
    id SERIAL PRIMARY KEY,
    user_id VARCHAR(50) UNIQUE NOT NULL,
    address VARCHAR(100) NOT NULL,
    encrypted_mnemonic TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Balances por token (cache, se sincroniza con blockchain)
CREATE TABLE token_balances (
    id SERIAL PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    token_address VARCHAR(100) NOT NULL, -- 'native' para TON
    token_symbol VARCHAR(20),
    token_name VARCHAR(100),
    token_decimals INTEGER DEFAULT 9,
    balance DECIMAL(30,9) DEFAULT 0,
    last_synced TIMESTAMP,
    UNIQUE(user_id, token_address)
);

-- Historial de transacciones
CREATE TABLE token_transactions (
    id SERIAL PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    token_address VARCHAR(100) NOT NULL,
    tx_type VARCHAR(20), -- 'deposit', 'withdraw', 'send', 'receive'
    amount DECIMAL(30,9),
    fee_amount DECIMAL(30,9),
    platform_fee DECIMAL(30,9),
    tx_hash VARCHAR(100),
    from_address VARCHAR(100),
    to_address VARCHAR(100),
    status VARCHAR(20), -- 'pending', 'completed', 'failed'
    created_at TIMESTAMP DEFAULT NOW()
);

-- ConfiguraciÃ³n de comisiones (admin)
CREATE TABLE withdrawal_fees (
    id SERIAL PRIMARY KEY,
    token_address VARCHAR(100) UNIQUE,
    fee_type VARCHAR(10), -- 'percent' o 'fixed'
    fee_value DECIMAL(10,4),
    min_withdrawal DECIMAL(30,9),
    is_active BOOLEAN DEFAULT true
);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
API ENDPOINTS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GET  /api/wallet/personal          - Obtener/crear wallet personal
GET  /api/wallet/assets            - Listar todos los tokens y balances
GET  /api/wallet/assets/{token}    - Detalle de un token especÃ­fico
GET  /api/wallet/transactions      - Historial general
GET  /api/wallet/transactions/{token} - Historial por token
POST /api/wallet/withdraw          - Solicitar retiro
POST /api/wallet/send              - Enviar a usuario interno
GET  /api/wallet/sync              - Forzar sincronizaciÃ³n con blockchain

ADMIN:
GET  /api/admin/wallet/fees        - Ver comisiones configuradas
POST /api/admin/wallet/fees        - Configurar comisiones

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DETECCIÃ“N DE DEPÃ“SITOS (Background Job):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Cada 30 segundos:
1. Obtener lista de wallets de usuarios activos
2. Para cada wallet, consultar transacciones recientes
3. Identificar transacciones nuevas (no procesadas)
4. Para cada tx:
   - Si es TON nativo: actualizar balance TON
   - Si es Jetton: identificar contrato, obtener metadata, actualizar balance
5. Registrar en token_transactions
6. Notificar al usuario (opcional: push/toast)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NOTAS TÃ‰CNICAS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

- Usar tonsdk para generar wallets y firmar transacciones
- TON Center API o similar para consultar balances Jetton
- Endpoint Jettons: GET /v2/accounts/{address}/jettons
- Encriptar mnemonics con clave derivada de SECRET_KEY
- Cache de balances con TTL 30 segundos
- Rate limiting en endpoints de retiro

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PENDIENTES PARA IMPLEMENTAR DESPUÃ‰S:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ ] Exchange interno (USDT â†” B3C, TON â†” B3C, etc.)
[ ] Comisiones por conversiÃ³n USDT â†’ B3C (actualmente gratis)
[ ] Comisiones por intercambio entre otros tokens
[ ] LÃ­mites de retiro diarios/mensuales
[ ] VerificaciÃ³n KYC para retiros grandes
[ ] Notificaciones push de depÃ³sitos

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
COMPATIBILIDAD:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

- Mantener sistema actual de consolidaciÃ³n para marketplace/escrow
- Migrar usuarios existentes: crear wallet personal en primer login
- Balance B3C actual se mantiene como estÃ¡ (es interno)
- esta  secciÃ³n es la de la wallet que ya tenemos con esto complementa, no reemplaza wallet actualâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BALANCE DISPONIBLE                  â”‚  â† SE MANTIENE
â”‚ 0.00 B3C                            â”‚
â”‚ ~$0.00 USD                          â”‚
â”‚ [â†“Depositar] [â†‘Retirar] [âŸ²Transf]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¼ MIS ACTIVOS                      â”‚  â† NUEVO (reemplaza Wallet TON)
â”‚ TOKENS PRINCIPALES                  â”‚
â”‚ ğŸª™ B3C         1,250.00       [â†’]   â”‚
â”‚ ğŸ’µ USDT           50.00       [â†’]   â”‚
â”‚ ğŸ’ TON             2.50       [â†’]   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
â”‚ OTROS TOKENS (detectados)          â”‚
â”‚ ğŸ• DOGS          100.00       [â†’]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜El QR y direcciÃ³n de depÃ³sito se mostrarÃ¡n solo cuando el usuario presione "Depositar" (en un modal o vista), no siempre visibles.